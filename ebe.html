<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Insight-Style Party Game with Rooms</title>
  <style>
    body { font-family: Arial, sans-serif; background: #181818; color: #fff; text-align: center; padding: 40px; }
    .container { max-width: 500px; margin: 0 auto; background: #222; padding: 30px; border-radius: 20px; box-shadow: 0 0 20px #000; }
    button { background: #e91e63; border: none; padding: 12px 25px; font-size: 16px; color: white; border-radius: 10px; cursor: pointer; margin-top: 20px; }
    button:hover { background: #c2185b; }
    .prompt { font-size: 22px; margin-top: 30px; min-height: 80px; }
    .player { margin-top: 10px; font-style: italic; }
    input, select { padding: 10px; border-radius: 8px; border: none; margin-top: 10px; width: 100%; }
    #playersList { margin-top: 10px; font-size: 14px; }
    #roomSection, #gameSection { margin-top: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>🎉 Insight Party Game</h1>
    
    <div id="roomSection">
      <input type="text" id="roomInput" placeholder="Enter room code (e.g. ABC123)" maxlength="10" />
      <button onclick="createRoom()">➕ Create Room</button>
      <button onclick="joinRoom()">🔑 Join Room</button>
      <p id="roomMessage"></p>
    </div>
    
    <div id="gameSection" style="display:none;">
      <p><strong>Room:</strong> <span id="roomCodeDisplay"></span></p>
      <input type="text" id="nameInput" placeholder="Enter player name" />
      <button onclick="addPlayer()">➕ Add Player</button>
      <div id="playersList"></div>
      <button onclick="generatePrompt()">🎲 New Prompt</button>
      <div class="prompt" id="prompt"></div>
      <div class="player" id="player"></div>
      <button onclick="leaveRoom()" style="margin-top:20px; background:#555;">🚪 Leave Room</button>
    </div>
  </div>

  <script>
    const prompts = [
      "Who here is most likely to ghost someone after a great date?",
      "Reveal something you've never told anyone in this room.",
      "If you had to swap lives with someone here, who would it be and why?",
      "What's your secret guilty pleasure?",
      "Name the person here most likely to survive a zombie apocalypse.",
      "What's a red flag you ignored in a past relationship?",
      "Give a compliment to the person to your left.",
      "What's something you pretend to like but secretly don't?",
      "If you could erase one memory, what would it be?",
      "Who in this room gives off main character energy?",
      "What's your most irrational fear?",
      "Who do you think would make a great villain in a movie?",
      "If you could time travel, what moment would you revisit?",
      "What's a lie you've told that no one here knows about?",
      "Which player would you want on your apocalypse team and why?",
      "What's your weirdest recurring dream?",
      "Name a song that describes your current life vibe.",
      "What’s one thing you’re too afraid to try but really want to?",
      "What's the pettiest reason you ever disliked someone?",
      "If your life was a meme, which one would it be?"
    ];

    let currentRoom = null;
    let players = [];

    function saveRoomData() {
      if (!currentRoom) return;
      const data = { players };
      localStorage.setItem('insight_room_' + currentRoom, JSON.stringify(data));
    }

    function loadRoomData(room) {
      const dataStr = localStorage.getItem('insight_room_' + room);
      if (dataStr) {
        try {
          const data = JSON.parse(dataStr);
          players = data.players || [];
          return true;
        } catch {
          players = [];
          return false;
        }
      }
      players = [];
      return false;
    }

    function updatePlayersList() {
      const listDiv = document.getElementById('playersList');
      if (players.length === 0) {
        listDiv.innerHTML = "<em>No players added yet.</em>";
      } else {
        listDiv.innerHTML = '<strong>Players:</strong> ' + players.join(', ');
      }
    }

    function createRoom() {
      let room = document.getElementById('roomInput').value.trim();
      if (!room) {
        alert("Please enter a room code to create.");
        return;
      }
      if (localStorage.getItem('insight_room_' + room)) {
        alert("Room code already exists. Please choose a different code or join this room.");
        return;
      }
      currentRoom = room;
      players = [];
      saveRoomData();
      enterGame();
      setRoomMessage(`Room "${room}" created! Share this code with friends to join.`);
    }

    function joinRoom() {
      let room = document.getElementById('roomInput').value.trim();
      if (!room) {
        alert("Please enter a room code to join.");
        return;
      }
      if (!loadRoomData(room)) {
        alert("Room not found. You can create it by pressing 'Create Room'.");
        return;
      }
      currentRoom = room;
      enterGame();
      setRoomMessage(`Joined room "${room}". Have fun!`);
    }

    function enterGame() {
      document.getElementById('roomSection').style.display = 'none';
      document.getElementById('gameSection').style.display = 'block';
      document.getElementById('roomCodeDisplay').innerText = currentRoom;
      updatePlayersList();
      clearPrompt();
      clearPlayer();
    }

    function addPlayer() {
      const input = document.getElementById('nameInput');
      const name = input.value.trim();
      if (!currentRoom) {
        alert("Please create or join a room first.");
        return;
      }
      if (!name) {
        alert("Please enter a player name.");
        return;
      }
      if (players.includes(name)) {
        alert("This player name is already added.");
        return;
      }
      players.push(name);
      input.value = '';
      updatePlayersList();
      saveRoomData();
    }

    function generatePrompt() {
      if (players.length === 0) {
        alert("Please add at least one player.");
        return;
      }
      const prompt = prompts[Math.floor(Math.random() * prompts.length)];
      const player = players[Math.floor(Math.random() * players.length)];
      document.getElementById('prompt').innerText = prompt;
      document.getElementById('player').innerText = `🔍 ${player}, you're up!`;
    }

    function setRoomMessage(msg) {
      document.getElementById('roomMessage').innerText = msg;
    }

    function leaveRoom() {
      if (confirm("Are you sure you want to leave the room?")) {
        currentRoom = null;
        players = [];
        document.getElementById('roomSection').style.display = 'block';
        document.getElementById('gameSection').style.display = 'none';
        document.getElementById('roomInput').value = '';
        document.getElementById('roomMessage').innerText = '';
        clearPrompt();
        clearPlayer();
      }
    }

    function clearPrompt() {
      document.getElementById('prompt').innerText = '';
    }
    function clearPlayer() {
      document.getElementById('player').innerText = '';
    }
  </script>
</body>
</html>
